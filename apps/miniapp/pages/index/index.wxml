<!--pages/index/index.wxml-->
<view class="index-page">
  <!-- ÊêúÁ¥¢Ê†è -->
  <view class="search-bar">
    <view class="search-input" bindtap="onSearchTap">
      <text class="search-placeholder">ÊêúÁ¥¢ËÇ°Á•®‰ª£Á†Å/ÂêçÁß∞</text>
      <text class="search-icon">üîç</text>
    </view>
  </view>

  <!-- Âä†ËΩΩÁä∂ÊÄÅ -->
  <view wx:if="{{loading}}" class="loading">
    <text>Âä†ËΩΩ‰∏≠...</text>
  </view>

  <!-- ‰∏ªË¶ÅÂÜÖÂÆπ -->
  <scroll-view wx:else scroll-y="true" class="content" refresher-enabled="{{true}}" refresher-triggered="{{refreshing}}" bindrefresherrefresh="refreshData">
    <!-- ËΩÆÊí≠Âõæ -->
    <view wx:if="{{banners.length > 0}}" class="banner-section">
      <swiper 
        class="banner-swiper" 
        indicator-dots="{{true}}" 
        autoplay="{{true}}" 
        interval="{{3000}}" 
        duration="{{500}}"
        bindchange="onBannerChange"
      >
        <swiper-item wx:for="{{banners}}" wx:key="id" bindtap="onBannerTap" data-index="{{index}}">
          <image class="banner-image" src="{{item.imageUrl}}" mode="aspectFill" />
          <view class="banner-overlay">
            <text class="banner-title">{{item.title}}</text>
          </view>
        </swiper-item>
      </swiper>
    </view>

    <!-- Â∏ÇÂú∫Ê¶ÇËßà -->
    <view class="market-section">
      <view class="section-header">
        <text class="section-title">Â∏ÇÂú∫Ê¶ÇËßà</text>
      </view>
      <view class="market-list">
        <view 
          class="market-item" 
          wx:for="{{[marketOverview.sh, marketOverview.sz, marketOverview.cy]}}" 
          wx:key="code"
          bindtap="onMarketTap" 
          data-code="{{item.code}}"
        >
          <view class="market-info">
            <text class="market-name">{{item.name}}</text>
            <text class="market-code">{{item.code}}</text>
          </view>
          <view class="market-data">
            <text class="market-price">{{formatPrice(item.price)}}</text>
            <text class="market-change {{getChangeColorClass(item.change)}}">
              {{formatChangePercent(item.changePercent)}}
            </text>
          </view>
        </view>
      </view>
    </view>

    <!-- ÁÉ≠Èó®ËÇ°Á•® -->
    <view class="hot-stocks-section">
      <view class="section-header">
        <text class="section-title">ÁÉ≠Èó®ËÇ°Á•®</text>
        <text class="section-more" bindtap="onMoreHotStocks">Êõ¥Â§ö ></text>
      </view>
      <view wx:if="{{hotStocks.length === 0}}" class="empty">
        <text class="empty-text">ÊöÇÊó†Êï∞ÊçÆ</text>
      </view>
      <view wx:else class="stock-list">
        <view 
          class="stock-item" 
          wx:for="{{hotStocks}}" 
          wx:key="code"
          bindtap="onStockTap" 
          data-code="{{item.code}}"
        >
          <view class="stock-info">
            <text class="stock-name">{{item.name}}</text>
            <text class="stock-code">{{item.code}}</text>
          </view>
          <view class="stock-data">
            <text class="stock-price">{{formatPrice(item.price)}}</text>
            <text class="stock-change {{getChangeColorClass(item.change)}}">
              {{formatChangePercent(item.changePercent)}}
            </text>
          </view>
        </view>
      </view>
    </view>

    <!-- ÊúÄÊñ∞ËµÑËÆØ -->
    <view class="news-section">
      <view class="section-header">
        <text class="section-title">ÊúÄÊñ∞ËµÑËÆØ</text>
        <text class="section-more" bindtap="onMoreNews">Êõ¥Â§ö ></text>
      </view>
      <view wx:if="{{news.length === 0}}" class="empty">
        <text class="empty-text">ÊöÇÊó†ËµÑËÆØ</text>
      </view>
      <view wx:else class="news-list">
        <view 
          class="news-item" 
          wx:for="{{news}}" 
          wx:key="id"
          bindtap="onNewsTap" 
          data-id="{{item.id}}"
        >
          <view class="news-content">
            <text class="news-title">{{item.title}}</text>
            <text class="news-summary">{{item.summary}}</text>
            <view class="news-meta">
              <text class="news-source">{{item.source}}</text>
              <text class="news-time">{{formatTime(item.publishTime)}}</text>
            </view>
          </view>
          <image wx:if="{{item.imageUrl}}" class="news-image" src="{{item.imageUrl}}" mode="aspectFill" />
        </view>
      </view>
    </view>
  </scroll-view>
</view>