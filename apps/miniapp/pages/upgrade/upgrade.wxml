<!--pages/upgrade/upgrade.wxml-->
<view class="upgrade-container">
  <!-- 页面标题 -->
  <view class="header">
    <view class="title">选择您的套餐</view>
    <view class="subtitle">解锁更多专业功能</view>
  </view>

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading">
    <view class="loading-text">加载中...</view>
  </view>

  <!-- 套餐对比 -->
  <view wx:else class="plans-container">
    <!-- FREE套餐 -->
    <view class="plan-card {{selectedPlan === 'free' ? 'selected' : ''}} {{currentPlan === 'free' ? 'current' : ''}}" 
          data-plan="free" bindtap="onPlanSelect">
      <view class="plan-header">
        <view class="plan-name">免费版</view>
        <view class="plan-price">¥0<text class="price-unit">/月</text></view>
        <view wx:if="{{currentPlan === 'free'}}" class="current-badge">当前套餐</view>
      </view>
      
      <view class="plan-features">
        <view class="feature-item">
          <text class="feature-icon">✓</text>
          <text class="feature-text">每日3次AI分析</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">✓</text>
          <text class="feature-text">最多10只自选股</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">✓</text>
          <text class="feature-text">最多5个价格提醒</text>
        </view>
        <view class="feature-item disabled">
          <text class="feature-icon">✗</text>
          <text class="feature-text">AI深度分析</text>
        </view>
        <view class="feature-item disabled">
          <text class="feature-icon">✗</text>
          <text class="feature-text">实时行情数据</text>
        </view>
        <view class="feature-item disabled">
          <text class="feature-icon">✗</text>
          <text class="feature-text">数据导出功能</text>
        </view>
      </view>
    </view>

    <!-- PRO套餐 -->
    <view class="plan-card pro {{selectedPlan === 'pro' ? 'selected' : ''}} {{currentPlan === 'pro' ? 'current' : ''}}" 
          data-plan="pro" bindtap="onPlanSelect">
      <view class="plan-header">
        <view class="plan-badge">推荐</view>
        <view class="plan-name">Pro会员</view>
        <view class="plan-price">¥29<text class="price-unit">/月</text></view>
        <view wx:if="{{currentPlan === 'pro'}}" class="current-badge">当前套餐</view>
      </view>
      
      <view class="plan-features">
        <view class="feature-item">
          <text class="feature-icon">✓</text>
          <text class="feature-text">每日50次AI分析</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">✓</text>
          <text class="feature-text">最多100只自选股</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">✓</text>
          <text class="feature-text">最多50个价格提醒</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">✓</text>
          <text class="feature-text">AI深度分析</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">✓</text>
          <text class="feature-text">实时行情数据</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">✓</text>
          <text class="feature-text">数据导出功能</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">✓</text>
          <text class="feature-text">高级图表分析</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">✓</text>
          <text class="feature-text">优先客服支持</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 操作按钮 -->
  <view wx:if="{{!loading}}" class="actions">
    <button class="upgrade-btn {{selectedPlan === 'pro' && currentPlan !== 'pro' ? 'primary' : 'disabled'}}" 
            bindtap="onUpgrade">
      <text wx:if="{{selectedPlan === 'pro' && currentPlan !== 'pro'}}">立即升级 Pro</text>
      <text wx:elif="{{currentPlan === 'pro'}}">您已是Pro会员</text>
      <text wx:else>选择套餐</text>
    </button>
    
    <view class="secondary-actions">
      <text class="link" bindtap="onCompareFeatures">详细功能对比</text>
      <text class="divider">|</text>
      <text class="link" bindtap="onContactService">联系客服</text>
    </view>
  </view>

  <!-- FAQ部分 -->
  <view wx:if="{{pricingInfo && pricingInfo.faq}}" class="faq-section">
    <view class="section-title">常见问题</view>
    <view wx:for="{{pricingInfo.faq}}" wx:key="question" class="faq-item">
      <view class="faq-question">{{item.question}}</view>
      <view class="faq-answer">{{item.answer}}</view>
    </view>
  </view>

  <!-- 底部说明 -->
  <view class="footer">
    <view class="footer-text">• 升级后立即生效，享受所有Pro功能</view>
    <view class="footer-text">• 支持随时取消，未使用部分按比例退款</view>
    <view class="footer-text">• 如有疑问，请联系客服获得帮助</view>
  </view>
</view>